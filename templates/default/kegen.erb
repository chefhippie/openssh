#!/bin/bash
# Generated by Chef for <%= node["fqdn"] %>

if ! grep -q '^[[:space:]]*HostKey[[:space:]]' <%= @config_file %>
then
  if ! test -f /etc/ssh/ssh_host_key
  then
    echo Generating /etc/ssh/ssh_host_key.
    ssh-keygen -t rsa1 -b 2048 -f /etc/ssh/ssh_host_key -N ''
  fi

  if ! test -f /etc/ssh/ssh_host_dsa_key
  then
    echo Generating /etc/ssh/ssh_host_dsa_key.
    ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key -N ''
  fi

  if ! test -f /etc/ssh/ssh_host_rsa_key
  then
    echo Generating /etc/ssh/ssh_host_rsa_key.
    ssh-keygen -t rsa -b 4096 -o -a 100 -f /etc/ssh/ssh_host_rsa_key -N ''
  fi

  if ! test -f /etc/ssh/ssh_host_ecdsa_key
  then
    echo Generating /etc/ssh/ssh_host_ecdsa_key.
    ssh-keygen -t ecdsa -b 256 -f /etc/ssh/ssh_host_ecdsa_key -N ''
  fi

  if ! test -f /etc/ssh/ssh_host_ed25519_key
  then
    echo Generating /etc/ssh/ssh_host_ed25519_key.
    ssh-keygen -t ed25519 -o -a 100 -f /etc/ssh/ssh_host_ed25519_key -N ''
  fi
fi
